(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[897],{6427:function(e){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CreateUser"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"data"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UserCreateInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createUser"},arguments:[{kind:"Argument",name:{kind:"Name",value:"data"},value:{kind:"Variable",name:{kind:"Name",value:"data"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"email"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"stripeId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"password"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isSet"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:146}};n.loc.source={body:"mutation CreateUser($data: UserCreateInput!) {\n  createUser(data: $data) {\n    name\n    email\n    stripeId\n    password {\n      isSet\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function t(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}n.definitions.forEach(function(e){if(e.name){var n=new Set;(function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&i.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach(function(n){e(n,i)}),n.variableDefinitions&&n.variableDefinitions.forEach(function(n){e(n,i)}),n.definitions&&n.definitions.forEach(function(n){e(n,i)})})(e,n),i[e.name.value]=n}}),e.exports=n,e.exports.CreateUser=function(e,n){var a={kind:e.kind,definitions:[t(e,n)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var r=i[n]||new Set,d=new Set,s=new Set;for(r.forEach(function(e){s.add(e)});s.size>0;){var o=s;s=new Set,o.forEach(function(e){d.has(e)||(d.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return d.forEach(function(n){var i=t(e,n);i&&a.definitions.push(i)}),a}(n,"CreateUser")},2166:function(e){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getCurrentUser"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticatedItem"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"User"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"email"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"stripeId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"cart"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"quantity"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"product"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"price"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"shortDescription"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"orders"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"charge"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"itemsCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"total"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"date"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"items"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"quantity"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"product"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"price"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"shortDescription"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"ordersCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"cartCount"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:608}};n.loc.source={body:"query getCurrentUser {\n  authenticatedItem {\n    ... on User {\n      email\n      id\n      name\n      stripeId\n      cart {\n        quantity\n        id\n        product {\n          id\n          price\n          shortDescription\n          title\n        }\n        user {\n          id\n        }\n      }\n      orders {\n        charge\n        id\n        itemsCount\n        total\n        date\n        items {\n          id\n          quantity\n          product {\n            id\n            price\n            title\n            shortDescription\n          }\n        }\n      }\n      ordersCount\n      cartCount\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function t(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}n.definitions.forEach(function(e){if(e.name){var n=new Set;(function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&i.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach(function(n){e(n,i)}),n.variableDefinitions&&n.variableDefinitions.forEach(function(n){e(n,i)}),n.definitions&&n.definitions.forEach(function(n){e(n,i)})})(e,n),i[e.name.value]=n}}),e.exports=n,e.exports.getCurrentUser=function(e,n){var a={kind:e.kind,definitions:[t(e,n)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var r=i[n]||new Set,d=new Set,s=new Set;for(r.forEach(function(e){s.add(e)});s.size>0;){var o=s;s=new Set,o.forEach(function(e){d.has(e)||(d.add(e),(i[e]||new Set).forEach(function(e){s.add(e)}))})}return d.forEach(function(n){var i=t(e,n);i&&a.definitions.push(i)}),a}(n,"getCurrentUser")},2039:function(e,n,i){Promise.resolve().then(i.bind(i,4730))},7907:function(e,n,i){"use strict";i.r(n);var t=i(5313),a={};for(var r in t)"default"!==r&&(a[r]=(function(e){return t[e]}).bind(0,r));i.d(n,a)},4730:function(e,n,i){"use strict";i.r(n),i.d(n,{default:function(){return v}});var t=i(3827),a=i(7907),r=i(2072),d=i(286),s=i(3012),o=i.n(s),l=i(2166),u=i.n(l),c=i(6427),m=i.n(c);function v(){let e=(0,a.useRouter)(),{inputs:n,handleChange:i,resetForm:s}=(0,r.Z)({name:"Name",email:"test@email.com",password:""}),[l,{loading:c,data:v,error:f}]=(0,d.D)(m(),{variables:n,refetchQueries:[{query:u()}]});async function k(i){var t;i.preventDefault();let a=await fetch("/api/create-customer-account",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:null==n?void 0:n.name,email:null==n?void 0:n.email})}).then(e=>e.json()),r=await l({variables:{data:{...n,stripeId:a.id}}});(null==r?void 0:null===(t=r.data)||void 0===t?void 0:t.createUser)&&e.push("/signin")}return(0,t.jsxs)("div",{className:o().formWrapper,children:[f&&f&&(0,t.jsx)("div",{className:o().errorMessage,children:(0,t.jsx)("p",{children:null==f?void 0:f.message})}),(0,t.jsx)("form",{method:"POST",onSubmit:e=>k(e),className:o().form,children:(0,t.jsxs)("fieldset",{disabled:c,className:o().fieldset,children:[(0,t.jsxs)("label",{htmlFor:"name",className:o().label,children:["Email",(0,t.jsx)("input",{name:"name",type:"text",id:"name",placeholder:"Name",value:n.name,onChange:i})]}),(0,t.jsxs)("label",{htmlFor:"email",className:o().label,children:["Email",(0,t.jsx)("input",{name:"email",type:"email",id:"email",placeholder:"email@address.com",value:n.email,onChange:i})]}),(0,t.jsxs)("label",{htmlFor:"password",className:o().label,children:["Password",(0,t.jsx)("input",{name:"password",type:"password",id:"password",value:n.password,onChange:i})]}),(0,t.jsx)("button",{type:"submit",className:o().button,children:"Sign In"})]})})]})}},2072:function(e,n,i){"use strict";i.d(n,{Z:function(){return a}});var t=i(4090);function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[n,i]=(0,t.useState)(e),a=Object.values(e).join();return(0,t.useEffect)(()=>{i(e)},[a]),{inputs:n,handleChange:function(e){let{value:t,name:a,type:r}=e.target;"number"===r&&(t=parseInt(t)),"file"===r&&(console.log("maybe I need to fiddle with this"),[t]=e.target.files),i({...n,[a]:t})},resetForm:function(){i(e)},clearForm:function(){i(Object.fromEntries(Object.entries(n).map(e=>{let[n,i]=e;return[n,""]})))}}}},3012:function(e){e.exports={fieldset:"form_fieldset__T2gM_",label:"form_label__5xHnE",errorMessage:"form_errorMessage__u1whG",createAccountWrapper:"form_createAccountWrapper__re13P",button:"form_button__RBl21",sucessMessage:"form_sucessMessage__HoBo9",formWrapper:"form_formWrapper__Hkm31",form:"form_form__RweKP"}},286:function(e,n,i){"use strict";i.d(n,{D:function(){return u}});var t=i(9703),a=i(6050),r=i(569),d=i(9058),s=i(1039),o=i(866),l=i(9259);function u(e,n){var i=(0,l.x)(null==n?void 0:n.client);(0,s.Vp)(e,s.n_.Mutation);var u=a.useState({called:!1,loading:!1,client:i}),c=u[0],m=u[1],v=a.useRef({result:c,mutationId:0,isMounted:!0,client:i,mutation:e,options:n});Object.assign(v.current,{client:i,options:n,mutation:e});var f=a.useCallback(function(e){void 0===e&&(e={});var n=v.current,i=n.options,a=n.mutation,s=(0,t.pi)((0,t.pi)({},i),{mutation:a}),l=e.client||v.current.client;v.current.result.loading||s.ignoreResults||!v.current.isMounted||m(v.current.result={loading:!0,error:void 0,data:void 0,called:!0,client:l});var u=++v.current.mutationId,c=(0,r.J)(s,e);return l.mutate(c).then(function(n){var i,t,a=n.data,r=n.errors,s=r&&r.length>0?new o.cA({graphQLErrors:r}):void 0,f=e.onError||(null===(i=v.current.options)||void 0===i?void 0:i.onError);if(s&&f&&f(s,c),u===v.current.mutationId&&!c.ignoreResults){var k={called:!0,loading:!1,data:a,error:s,client:l};v.current.isMounted&&!(0,d.D)(v.current.result,k)&&m(v.current.result=k)}var p=e.onCompleted||(null===(t=v.current.options)||void 0===t?void 0:t.onCompleted);return s||null==p||p(n.data,c),n}).catch(function(n){if(u===v.current.mutationId&&v.current.isMounted){var i,t={loading:!1,error:n,data:void 0,called:!0,client:l};(0,d.D)(v.current.result,t)||m(v.current.result=t)}var a=e.onError||(null===(i=v.current.options)||void 0===i?void 0:i.onError);if(a)return a(n,c),{data:void 0,errors:n};throw n})},[]),k=a.useCallback(function(){if(v.current.isMounted){var e={called:!1,loading:!1,client:i};Object.assign(v.current,{mutationId:0,result:e}),m(e)}},[]);return a.useEffect(function(){return v.current.isMounted=!0,function(){v.current.isMounted=!1}},[]),[f,(0,t.pi)({reset:k},c)]}}},function(e){e.O(0,[28,971,69,744],function(){return e(e.s=2039)}),_N_E=e.O()}]);